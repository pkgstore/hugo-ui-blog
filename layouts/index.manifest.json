{{ $cfg := (site.Params.manifest) }}
{{ $icons := (site.Data.ui.icons) }}
{{ $lang := (site.Language.Lang) }}
{{ $data := (newScratch) }}

{{ ($data.Add "categories" (slice)) }}
{{ range ($cfg.categories) }}
    {{ ($data.Add "categories" .) }}
{{ end }}

{{ ($data.Add "icons" (slice)) }}

{{ range ($icons.sizes) }}
    {{ ($data.Add "icons" (dict
    "src" ((printf "favicon-%s.png" .) | relURL)
    "sizes" (printf "%sx%s" . .)
    "type" "image/png"
    )) }}
{{ end }}

{{ ($data.Add "icons" (dict
"src" (("favicon.ico") | relURL)
"sizes" "any"
"type" "image/x-icon"
)) }}

{{ ($data.Add "icons" (dict
"src" (("favicon.svg") | relURL)
"sizes" "any"
"type" "image/svg+xml"
)) }}

{{ $mainfest := (dict
"id" "/"
"name" (site.Title)
"short_name" (index ($cfg.short_name) ($lang))
"description" (site.Params.description)
"start_url" "/"
"scope" "/"
"display" "standalone"
"background_color" ($cfg.color.background)
"theme_color" ($cfg.color.theme)
"categories" ($data.Get "categories")
"icons" ($data.Get "icons")
) }}

{{ (($mainfest) | jsonify) }}
